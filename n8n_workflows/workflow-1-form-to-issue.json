{
  "name": "Workflow #1: Google Form â†’ GitHub Issue",
  "active": true,
  "nodes": [
    {
      "id": "webhook-trigger",
      "name": "Google Form Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1.1,
      "position": [250, 300],
      "parameters": {
        "path": "google-form-to-issue",
        "httpMethod": "POST",
        "responseMode": "lastNode"
      }
    },
    {
      "id": "validate-data",
      "name": "ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [450, 300],
      "parameters": {
        "jsCode": "const requiredFields = ['title', 'description', 'priority', 'category'];\nconst data = $input.item.json;\n\n// å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯\nfor (const field of requiredFields) {\n  if (!data[field]) {\n    throw new Error(`å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒä¸è¶³: ${field}`);\n  }\n}\n\n// å„ªå…ˆåº¦ã®æ¤œè¨¼\nconst validPriorities = ['high', 'medium', 'low'];\nif (!validPriorities.includes(data.priority)) {\n  data.priority = 'medium'; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ\n}\n\n// ã‚«ãƒ†ã‚´ãƒªã®æ¤œè¨¼\nconst validCategories = ['feature', 'bug', 'enhancement'];\nif (!validCategories.includes(data.category)) {\n  data.category = 'feature'; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ\n}\n\nreturn [{\n  json: {\n    title: data.title.trim(),\n    body: `## è¦ä»¶å†…å®¹\\n${data.description}\\n\\n## è©³ç´°\\n- **å„ªå…ˆåº¦**: ${data.priority}\\n- **ã‚«ãƒ†ã‚´ãƒª**: ${data.category}\\n- **è¦æ±‚è€…**: ${data.requester || 'ä¸æ˜'}\\n\\n---\\nğŸ¤– Google Form ã‹ã‚‰è‡ªå‹•ä½œæˆ`,\n    labels: [data.category, `priority: ${data.priority}`],\n    priority: data.priority,\n    requester: data.requester || 'ä¸æ˜'\n  }\n}];"
      }
    },
    {
      "id": "create-issue",
      "name": "GitHub Issue ä½œæˆ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [650, 300],
      "parameters": {
        "url": "https://api.github.com/repos/kenichimiyata/ai-automation-dashboard/issues",
        "method": "POST",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer {{$env.GITHUB_TOKEN}}"
            },
            {
              "name": "Accept",
              "value": "application/vnd.github+json"
            },
            {
              "name": "X-GitHub-Api-Version",
              "value": "2022-11-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ { \"title\": $json.title, \"body\": $json.body, \"labels\": $json.labels } }}"
      }
    },
    {
      "id": "notify-chat",
      "name": "Google Chat é€šçŸ¥",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [850, 300],
      "parameters": {
        "url": "={{$env.GOOGLE_CHAT_WEBHOOK}}",
        "method": "POST",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ { cardsV2: [{ card: { header: { title: \"ğŸ“ æ–°è¦Issueä½œæˆï¼ˆGoogle Formï¼‰\", subtitle: \"Issue #\" + $('create-issue').item.json.number, imageUrl: \"https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png\" }, sections: [{ header: \"è©³ç´°æƒ…å ±\", widgets: [ { textParagraph: { text: \"<b>ã‚¿ã‚¤ãƒˆãƒ«:</b><br>\" + $('create-issue').item.json.title } }, { textParagraph: { text: \"<b>å„ªå…ˆåº¦:</b> \" + $('validate-data').item.json.priority } }, { textParagraph: { text: \"<b>è¦æ±‚è€…:</b> \" + $('validate-data').item.json.requester } } ] }, { widgets: [{ buttonList: { buttons: [{ text: \"Issue ã‚’é–‹ã\", onClick: { openLink: { url: $('create-issue').item.json.html_url } } }] } }] }] } }] } }}"
      }
    },
    {
      "id": "return-response",
      "name": "ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¿”å´",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1050, 300],
      "parameters": {
        "jsCode": "return [{\n  json: {\n    status: 'success',\n    message: 'Issueä½œæˆå®Œäº†',\n    issue_url: $('create-issue').item.json.html_url,\n    issue_number: $('create-issue').item.json.number,\n    created_at: $('create-issue').item.json.created_at\n  }\n}];"
      }
    }
  ],
  "connections": {
    "webhook-trigger": {
      "main": [
        [
          {
            "node": "validate-data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "validate-data": {
      "main": [
        [
          {
            "node": "create-issue",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "create-issue": {
      "main": [
        [
          {
            "node": "notify-chat",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "notify-chat": {
      "main": [
        [
          {
            "node": "return-response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "tags": [
    {
      "name": "ai-automation",
      "id": "auto-1"
    }
  ]
}
